import requests
from bs4 import BeautifulSoup
import re
import sys

# for 6th sem - 2018
CONST_VIEWSTATE = """/wEPDwUJMjIwMjE3NzMyD2QWAgIDD2QWFgIBD2QWAgIFDw8WAh4EVGV4dAU0UmVzdWx0cyAoMy1ZZWFyIFNlbWVzdGVyIEV4YW1pbmF0aW9uIE1heS1KdW5lIDIwMTggKWRkAgUPDxYCHwAFECAoTWF5LUp1bmUgMjAxOClkZAILDw8WAh4HVmlzaWJsZWhkZAIRDxAPFgYeDURhdGFUZXh0RmllbGQFCUNPTExfTkFNRR4ORGF0YVZhbHVlRmllbGQFCUNPTExfQ09ERR4LXyFEYXRhQm91bmRnZBAVYRI8LS0tLS1TZWxlY3QtLS0tLT4iQWNoYXJ5YSBOYXJlbmRyYSBEZXYgQ29sbGVnZS0oMDAxKRlBZGl0aSBNYWhhdmlkeWFsYXlhLSgwMDIpQ0FyeWFiaGF0dGEgQ29sbGVnZSBbRm9ybWVybHkgUmFtIExhbCBBbmFuZCBDb2xsZWdlIChFdmVuaW5nKV0tKDA1OSklQXRtYSBSYW0gU2FuYXRhbiBEaGFyYW0gQ29sbGVnZS0oMDAzKR5CaGFnaW5pIE5pdmVkaXRhIENvbGxlZ2UtKDAwNykVQmhhcmF0aSBDb2xsZWdlLSgwMDgpMEJoYXNrYXJhY2hhcnlhIENvbGxlZ2Ugb2YgQXBwbGllZCBTY2llbmNlcy0oMDA5KRdDQU1QVVMgTEFXIENFTlRSRS0oMzA5KR1DYW1wdXMgb2YgT3BlbiBMZWFybmluZy0oQ09MKShDbHVzdGVyIElubm92YXRpb24gQ2VudHJlIChDLkkuQy4pLSgzMTIpI0NvbGxlZ2UgT2YgVm9jYXRpb25hbCBTdHVkaWVzLSgwMTMpGERhdWxhdCBSYW0gQ29sbGVnZS0oMDE0KSJEZWVuIERheWFsIFVwYWRoeWF5YSBDb2xsZWdlLSgwMTUpJkRlbGhpIENvbGxlZ2UgT2YgQXJ0cyAmIENvbW1lcmNlLSgwMTYpIERlbGhpIFNjaG9vbCBvZiBKb3VybmFsaXNtLSgzMTYpeERlcGFydG1lbnQgb2YgQm90YW55ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0oMjE2KXhEZXBhcnRtZW50IG9mIENoZW1pc3RyeSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtKDIxNykcRGVwYXJ0bWVudCBvZiBDb21tZXJjZS0oMjQxKXhEZXBhcnRtZW50IG9mIENvbXB1dGVyIFNjaWVuY2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtKDIzNCkdRGVwYXJ0bWVudCBvZiBFZHVjYXRpb24tKDI0MykbRGVwYXJ0bWVudCBvZiBFbmdsaXNoLSgyMDMpHURlcGFydG1lbnQgb2YgR2VvZ3JhcGh5LSgyMjkpMERlcGFydG1lbnQgb2YgR2VybWFuaWMgYW5kIFJvbWFuY2UgU3R1ZGllcy0oMjA0KRlEZXBhcnRtZW50IG9mIEhpbmRpLSgyMDUpG0RlcGFydG1lbnQgb2YgSGlzdG9yeS0oMjMxKTNEZXBhcnRtZW50IG9mIExpYnJhcnkgYW5kIEluZm9ybWF0aW9uIFNjaWVuY2UtKDIwNil4RGVwYXJ0bWVudCBvZiBNYXRoZW1hdGljcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSgyMzUpGURlcGFydG1lbnQgb2YgTXVzaWMtKDI0MCl4RGVwYXJ0bWVudCBvZiBQaHlzaWNzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSgyMjIpJURlcGFydG1lbnQgb2YgUG9saXRpY2FsIFNjaWVuY2UtKDIzMikcRGVwYXJ0bWVudCBvZiBTYW5za3JpdC0oMjEzKXhEZXBhcnRtZW50IG9mIFNvY2lhbCBXb3JrICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtKDIzMyl4RGVwYXJ0bWVudCBvZiBTdGF0aXN0aWNzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLSgyMzcpeERlcGFydG1lbnQgb2YgWm9vbG9neSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0oMjIzKR5EZXNoYmFuZGh1IENvbGxlZ2UgKERheSktKDAxOSkjRHIuIEJoaW0gUmFvIEFtYmVka2FyIENvbGxlZ2UtKDAxMCk0RHVyZ2FiYWkgRGVzaG11a2ggQ29sbGVnZSBvZiBTcGVjaWFsIEVkdWNhdGlvbi0oMzE0KR5EeWFsIFNpbmdoIENvbGxlZ2UgKERheSktKDAyMSkeRHlhbCBTaW5naCBDb2xsZWdlIChFdmUpLSgwMjIpI0ZhY3VsdHkgb2YgTWFuYWdlbWVudCBTdHVkaWVzLSgxMDkpE0dhcmdpIENvbGxlZ2UtKDAyNCkWSGFucyBSYWogQ29sbGVnZS0oMDI1KRNIaW5kdSBDb2xsZWdlLSgwMjYpG0kuUC5Db2xsZWdlIEZvciBXb21lbi0oMDI5KTxJbmRpcmEgR2FuZGhpIEluc3RpdHV0ZSBvZiBQaHkuIEVkdS4gJiBTcG9ydHMgU2NpZW5jZXMtKDAyOCkhSW5zdGl0dXRlIE9mIEhvbWUgRWNvbm9taWNzLSgwMzApIUphbmtpIERldmkgTWVtb3JpYWwgQ29sbGVnZS0oMDMxKRpKZXN1cyAmIE1hcnkgQ29sbGVnZS0oMDMyKRJKdWJpbGVlIEhhbGwtKDMwNikVS2FsaW5kaSBDb2xsZWdlLSgwMzMpGUthbWxhIE5laHJ1IENvbGxlZ2UtKDAzNCkaS2VzaGF2IE1haGF2aWR5YWxheWEtKDAzNSkYS2lyb3JpIE1hbCBDb2xsZWdlLSgwMzYpGExhZHkgSXJ3aW4gQ29sbGVnZS0oMDM4KSRMYWR5IFNyaSBSYW0gQ29sbGVnZSBGb3IgV29tZW4tKDAzOSkYTGFrc2htaWJhaSBDb2xsZWdlLSgwNDApEkxBVyBDRU5UUkUtSS0oMzEwKRNMQVcgQ0VOVFJFLUlJLSgzMTEpHk1haGFyYWphIEFncmFzZW4gQ29sbGVnZS0oMDQxKStNYWhhcnNoaSBWYWxtaWtpIENvbGxlZ2Ugb2YgRWR1Y2F0aW9uLSgzMTUpFk1haXRyZXlpIENvbGxlZ2UtKDA0MykjTWF0YSBTdW5kcmkgQ29sbGVnZSBGb3IgV29tZW4tKDA0NCkTTWlyYW5kYSBIb3VzZS0oMDQ3KSJNb3RpIExhbCBOZWhydSBDb2xsZWdlIChEYXkpLSgwNDgpIk1vdGkgTGFsIE5laHJ1IENvbGxlZ2UgKEV2ZSktKDA0OSkeUC5HLkQuQS5WLiBDb2xsZWdlIChEYXkpLSgwNTMpHlAuRy5ELkEuVi4gQ29sbGVnZSAoRXZlKS0oMDU0KRZSYWpkaGFuaSBDb2xsZWdlLSgwNTUpIVJhbSBMYWwgQW5hbmQgQ29sbGVnZSAoRGF5KS0oMDU4KRdSYW1hbnVqYW4gQ29sbGVnZS0oMDIwKRRSYW1qYXMgQ29sbGVnZS0oMDU2KR1TLkcuVC5CLiBLaGFsc2EgQ29sbGVnZS0oMDY4KR1TYXR5YXdhdGkgQ29sbGVnZSAoRGF5KS0oMDYyKR1TYXR5YXdhdGkgQ29sbGVnZSAoRXZlKS0oMDYzKR1TY2hvb2wgb2YgT3BlbiBMZWFybmluZy0oU09MKShTaGFoZWVkIEJoYWdhdCBTaW5naCBDb2xsZWdlIChEYXkpLSgwNjQpKFNoYWhlZWQgQmhhZ2F0IFNpbmdoIENvbGxlZ2UgKEV2ZSktKDA2NSk7U2hhaGVlZCBSYWpndXJ1IENvbGxlZ2Ugb2YgQXBwbGllZCBTY2llbmNlcyBmb3IgV29tZW4tKDA2NikxU2hhaGVlZCBTdWtoZGV2IENvbGxlZ2Ugb2YgQnVzaW5lc3MgU3R1ZGllcy0oMDY3KRVTaGl2YWppIENvbGxlZ2UtKDA3MSkdU2h5YW0gTGFsIENvbGxlZ2UgKERheSktKDA3MykdU2h5YW0gTGFsIENvbGxlZ2UgKEV2ZSktKDA3NCklU2h5YW1hIFByYXNhZCBNdWtoZXJqZWUgQ29sbGVnZS0oMDc1KR1TT0wgU3R1ZHkgQ2VudGVyIFNvdXRoLShTT0xTKSFTcmkgQXVyb2JpbmRvIENvbGxlZ2UgKERheSktKDA3NikhU3JpIEF1cm9iaW5kbyBDb2xsZWdlIChFdmUpLSgwNzcpL1NyaSBHdXJ1IEdvYmluZCBTaW5naCBDb2xsZWdlIE9mIENvbW1lcmNlLSgwNzgpJ1NyaSBHdXJ1IE5hbmFrIERldiBLaGFsc2EgQ29sbGVnZS0oMDY5KSFTcmkgUmFtIENvbGxlZ2UgT2YgQ29tbWVyY2UtKDA3MikeU3JpIFZlbmthdGVzd2FyYSBDb2xsZWdlLSgwNzkpGlN0LiBTdGVwaGVucyBDb2xsZWdlLSgwODApIFN3YW1pIFNocmFkZGhhbmFuZCBDb2xsZWdlLSgwODEpGVVuaXZlcnNpdHkgb2YgRGVsaGktKDEwMCkZVml2ZWthbmFuZGEgQ29sbGVnZS0oMDg0KSBaYWtpciBIdXNhaW4gQ29sbGVnZSAoRXZlKS0oMDg2KSZaYWtpciBIdXNhaW4gRGVsaGkgQ29sbGVnZSAoRGF5KS0oMDg1KRVhEjwtLS0tLVNlbGVjdC0tLS0tPgMwMDEDMDAyAzA1OQMwMDMDMDA3AzAwOAMwMDkDMzA5A0NPTAMzMTIDMDEzAzAxNAMwMTUDMDE2AzMxNgMyMTYDMjE3AzI0MQMyMzQDMjQzAzIwMwMyMjkDMjA0AzIwNQMyMzEDMjA2AzIzNQMyNDADMjIyAzIzMgMyMTMDMjMzAzIzNwMyMjMDMDE5AzAxMAMzMTQDMDIxAzAyMgMxMDkDMDI0AzAyNQMwMjYDMDI5AzAyOAMwMzADMDMxAzAzMgMzMDYDMDMzAzAzNAMwMzUDMDM2AzAzOAMwMzkDMDQwAzMxMAMzMTEDMDQxAzMxNQMwNDMDMDQ0AzA0NwMwNDgDMDQ5AzA1MwMwNTQDMDU1AzA1OAMwMjADMDU2AzA2OAMwNjIDMDYzA1NPTAMwNjQDMDY1AzA2NgMwNjcDMDcxAzA3MwMwNzQDMDc1BFNPTFMDMDc2AzA3NwMwNzgDMDY5AzA3MgMwNzkDMDgwAzA4MQMxMDADMDg0AzA4NgMwODUUKwNhZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2RkAhkPEGRkFgECAWQCIQ8QDxYGHwIFCUVYQU1fRkxBRx8DBQlFWEFNX0ZMQUcfBGdkEBUFEzwtLS0tLVNlbGVlY3QtLS0tLT4EQ0JDUw5VR19TRU1FU1RFUl8zWQ5VR19TRU1FU1RFUl80WQ5QR19TRU1FU1RFUl8yWRUFEzwtLS0tLVNlbGVlY3QtLS0tLT4EQ0JDUw5VR19TRU1FU1RFUl8zWQ5VR19TRU1FU1RFUl80WQ5QR19TRU1FU1RFUl8yWRQrAwVnZ2dnZxYBAgFkAikPEGRkFgECAmQCMQ8QDxYGHwIFC0NPVVJTRV9OQU1FHwMFC0NPVVJTRV9DT0RFHwRnZBAVHBI8LS0tLS1TZWxlY3QtLS0tLT4nKENCQ1MpIEIuUC5FRC4gVFdPIFlFQVIgUFJPR1JBTU1FLSg1OTUpQShDQkNTKSBCLlNjLiAoUEhZU0lDQUwgRURVQ0FUSU9OLEhFQUxUSCBFRFVDQVRJT04gJiBTUE9SVFMpLSg1ODkpJyhDQkNTKSBCLlNDLiBBTkFMWVRJQ0FMIENIRU1JU1RSWS0oNTg1KVAoQ0JDUykgQi5TQy4gQVBQTElFRCBMSUZFIFNDSUVOQ0VTIFdJVEggQUdSTy1DSEVNSUNBTFMgQU5EIFBFU1QgTUFOQUdFTUVOVC0oNTg2KScoQ0JDUykgQi5TQy4gSU5EVVNUUklBTCBDSEVNSVNUUlktKDU4NCkfKENCQ1MpIEIuU0MuIExJRkUgU0NJRU5DRS0oNTgzKSMoQ0JDUykgQi5TQy4gUEhZU0lDQUwgU0NJRU5DRS0oNTgyKSYoQ0JDUykgQi5TQy4oSE9OUy4pIEFOVEhST1BPTE9HWS0oNTUxKSYoQ0JDUykgQi5TQy4oSE9OUy4pIEJJT0NIRU1JU1RSWS0oNTUzKS0oQ0JDUykgQi5TQy4oSE9OUy4pIEJJT0xPR0lDQUwgU0NJRU5DRSAtKDU1NSktKENCQ1MpIEIuU0MuKEhPTlMuKSBCSU9NRURJQ0FMIFNDSUVOQ0VTLSg1NTQpIChDQkNTKSBCLlNDLihIT05TLikgQk9UQU5ZLSg1NTYpJChDQkNTKSBCLlNDLihIT05TLikgQ0hFTUlTVFJZIC0oNTU3KSooQ0JDUykgQi5TQy4oSE9OUy4pIENPTVBVVEVSIFNDSUVOQ0UtKDU3MCksKENCQ1MpIEIuU0MuKEhPTlMuKSBFTEVDVFJPTklDIFNDSUVOQ0UtKDU1OCkpKENCQ1MpIEIuU0MuKEhPTlMuKSBGT09EIFRFQ0hOT0xPR1ktKDU1OSkhKENCQ1MpIEIuU0MuKEhPTlMuKSBHRU9MT0dZLSg1NjApJihDQkNTKSBCLlNDLihIT05TLikgSE9NRSBTQ0lFTkNFLSg1NjEpKShDQkNTKSBCLlNDLihIT05TLikgSU5TVFJVTUVOVEFUSU9OLSg1NjIpJShDQkNTKSBCLlNDLihIT05TLikgTUFUSEVNQVRJQ1MtKDU2MykmKENCQ1MpIEIuU0MuKEhPTlMuKSBNSUNST0JJT0xPR1ktKDU2NCkiKENCQ1MpIEIuU0MuKEhPTlMuKSBQSFlTSUNTIC0oNTY3KSkoQ0JDUykgQi5TQy4oSE9OUy4pIFBPTFlNRVIgU0NJRU5DRS0oNTY2KSQoQ0JDUykgQi5TQy4oSE9OUy4pIFNUQVRJU1RJQ1MtKDU2OCkhKENCQ1MpIEIuU0MuKEhPTlMuKSBaT09MT0dZLSg1NjkpJShDQkNTKSBCLlNDLihQQVNTKSBIT01FIFNDSUVOQ0UtKDU5MSkqKENCQ1MpLUIuU0MuIChNQVRIRU1BVElDQUwgU0NJRU5DRVMpLSg1ODcpFRwSPC0tLS0tU2VsZWN0LS0tLS0+AzU5NQM1ODkDNTg1AzU4NgM1ODQDNTgzAzU4MgM1NTEDNTUzAzU1NQM1NTQDNTU2AzU1NwM1NzADNTU4AzU1OQM1NjADNTYxAzU2MgM1NjMDNTY0AzU2NwM1NjYDNTY4AzU2OQM1OTEDNTg3FCsDHGdnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2cWAQIOZAI5DxAPFgYfAgUEUEFSVB8DBQRQQVJUHwRnZBAVBRI8LS0tLS1TZWxlY3QtLS0tLT4BSQJJSQNJSUkCSVYVBRI8LS0tLS1TZWxlY3QtLS0tLT4BSQJJSQNJSUkCSVYUKwMFZ2dnZ2cWAQIDZAI/DxAPFgYfAgUDU0VNHwMFA1NFTR8EZ2QQFQMSPC0tLS0tU2VsZWN0LS0tLS0+AVYCVkkVAxI8LS0tLS1TZWxlY3QtLS0tLT4BVgJWSRQrAwNnZ2dkZAJXDw8WAh8BaGRkZFg+YSjaISfwKA4SgIHyzB2Awkbk"""
CONST_EVENTVALIDATION = """/wEWnQECxsCMNwKrw9qnCgKCqc+VAQLKlPHFDgLA/IyBCALl6+6qAgLopo/rCQL+gsG3BALi5fmADwLXj7neBwLoppvrCQLvppvrCQKewq+LCALY6+KqAgL+gsW3BAKTuKfBCQK017nqAwLJzpv3BQLMzpv3BQLPzpv3BQLg5f2ADwLG/LyBCAKRuN/ACQL8gvG3BAL8gsG3BALuppPrCQKRuKPBCQKq14XqAwLG/LiBCALPzuf3BQKq17HqAwKtxdr3BgLb6+aqAgLb65qqAgL8gsW3BAL8gv23BALg5fWADwL8gvm3BALopp/rCQKvxa70BgKWuKfBCQLA/ISBCALl6+aqAgLpppvrCQKTuNvACQK0173qAwLJzp/3BQLoppPrCQLXj7HeBwKvxab0BgLA/LiBCALl65qqAgLMzuf3BQL+gv23BAKTuN/ACQK017HqAwLJzpP3BQLXj7XeBwLoppfrCQKvxdr3BgKixa70BgLH/ICBCALA/LyBCAKr17nqAwL+gvG3BAKTuNPACQLi5emADwLXj6neBwLopovrCQL+gvW3BAKTuNfACQK016nqAwLXj63eBwKvxaL0BgLJzov3BQLXj6HeBwLl65aqAgL+gum3BAKuwq+LCAKTuMvACQK0163qAwLJzo/3BQLi5eGADwLA/KiBCAL+gu23BAKTuM/ACQK016HqAwKuwqv+CQLJzoP3BQLi5eWADwLXj6XeBwLopoPrCQLl64qqAgLopofrCQKvxYr0BgLA/OyBCAKsxar0BgKTuIPBCQLJzsf3BQK01+XqAwKjosWyCQLs3ZO5CgLR2dWyDALpvqyACALYz62KDAKAjfS0DwKAxvzOBwL25u3uBwL/5u3uBwKEw+/uBwLM9PumDwLLnPhJAoTjrsIDAo7DtdIEAqbz5rkMAv2OmvwHAuXzrHECqoz6+gMCyc+S1Q4Cjb7w1AQCyc/u1Q4CotbMyAgC9KCI/gQCk5qqiwkCvvPFlQ8CpeS7vgUCk5r+iAkCyc+i1Q4C9KDc/wQCotaAyAgCh/3mvwICwN3dyAsCqJem4QoCjb6E1AQCwN3ZyAsCpeS/vgUCvvOdlQ8Ck5riiAkC9KDA/wQCh/3qvwICotaEyAgCqJeq4QoCjb6I1AQCpeTrvgUCh/3SvwICgYSW4wICzvvA6AEC5uu8jQ4C5uvQkw4C1enQ5gUC5uvEkw4C3L7XvQ0C+a6r2AIC+a7HxgICtPew8AwCxISEgAsCpZ/ziwIE79yfOomdaRS3+pDKsOJ2U8Z9rg=="""
CONST_VIEWSTATE_GENERATOR = """A428D73D"""

# store marks list for all DU
college_sgpa_list = []

# list codes for all CS colleges
all_colleges = [
    "15001570001",
    "15003570001",
    "15009570001",
    "15013570001",
    "15015570001",
    "15020570001",
    "15021570001",
    "15025570001",
    "15029570001",
    "15033570001",
    "15035570001",
    "15044570001",
    "15053570001",
    "15058570001",
    "15059570001",
    "15066570001",
    "15067570001",
    "15068570001",
    "15075570001",
    "15078570001"
    ]

# all_colleges = [
#     "15025570001"
# ]

for col in all_colleges:
    CONST_college_roll_no = col
    VAR_college_Code = CONST_college_roll_no[2:5]

    r= requests.get('http://duexam2.du.ac.in/RSLT_MJ2018/Students/List_Of_Students.aspx?StdType=REG&ExamFlag=CBCS&CourseCode=570&CourseName=(CBCS)%20B.SC.(HONS.)%20COMPUTER%20SCIENCE&Part=III&Sem=VI')
    soup = None
    while soup == None:
        soup = BeautifulSoup(r.text, 'html.parser')
    
    students_table = soup.find("table", {"rules": "all"})
    data = []
    all_students = students_table.find_all('tr')

    for student in all_students:
        cols = student.find_all('td')
        cols = [ele.text.strip() for ele in cols]
        data.append([ele for ele in cols if ele]) # Get rid of empty values


    data[0] = ['sno','srollno','sname','sfathername']
    data.pop(0)

    roll_no_pattern = CONST_college_roll_no[:-3] + '...'

    dduc = []
    for student in data:
        if re.match(roll_no_pattern,student[1]):
            dduc.append(student)
        
    # print(*dduc,sep="\n")

    # dduc = [
    #     ['37', '15001570041', 'SONU  KUMAR', 'MR. PREM KUMAR'],
    #     ['39', '15001570043', 'VARAD  SRIVASTAVA', 'MR. RATNESH MOHAN SRIVASTAVA']
    # ]
   
    for VAR_stud in dduc:
        VAR_rollno = VAR_stud[1]
        VAR_sname = VAR_stud[2]
        
        payload = {
            'ddlcollege' : VAR_college_Code,
            'ddlexamtype' : 'Semester',
            'ddlexamflag' : 'CBCS',
            'ddlstream' : 'SC',
            'ddlcourse' : '570',
            'ddlpart' : 'III',
            'ddlsem': 'VI',
            'txtrollno' : VAR_rollno,
            'txtname' : VAR_sname,
            'btnsearch': 'Print Score Cart/Transcript',
            '__EVENTTARGET' : '',
            '__EVENTARGUMENT' : '',
            '__LASTFOCUS':'',
            '__VIEWSTATE': CONST_VIEWSTATE,
            '__EVENTVALIDATION': CONST_EVENTVALIDATION,
            '__VIEWSTATEGENERATOR' : CONST_VIEWSTATE_GENERATOR
            }

        soup = None
        while(soup == None):
            r = requests.post("http://duexam2.du.ac.in/RSLT_MJ2018/Students/Combine_GradeCard.aspx", data=payload)
            # print(r.text)
            soup = BeautifulSoup(r.text, 'html.parser')
            if(soup==None):
                continue
            # print(soup.title.string)
            if(soup.title.string == "Runtime Error"):
                soup = None
                continue
        
        for img in soup.find_all('img'):
            img.decompose()

        #t = soup.find('span', attrs={'id':'lblstatement'}).decompose()
        #t = soup.find('span', attrs={'id':'lbl_sub_head3'}).decompose()
        #t = soup.find('span', attrs={'id':'lbldisclaimer'}).decompose()
		
        sgpa_table = soup.find("span", {"id": "lbl_gr_cgpa"})
        if(sgpa_table == None ):
            continue
        try:
            sgpa_row = [x.strip() for x in sgpa_table.text.replace(',',':').split(':')]
            FINAL_CGPA = float(sgpa_row[1])
            # print([VAR_rollno, VAR_sname, FINAL_CGPA])
        except IndexError:
            continue
        college_sgpa_list.append([VAR_rollno, VAR_sname, FINAL_CGPA])
        
        '''
        # writing result to html file
        
        VAR_filename = "dduc_marks/" + VAR_rollno + '__' + VAR_sname + '__' + '.html'
        with open(VAR_filename, "w") as file:
            file.write(str(soup))
        '''

college_sgpa_list.sort(key = lambda x : x[2], reverse=True)
#print(college_sgpa_list)

# print to file
with open('DU-2015-2018-Batch-Result.txt','w') as f:
    print('{3:<5} {0:15} {1:25} {2:5}'.format("Roll No.","Name","SGPA","S.No"), file=f)
    for i,marks in enumerate(college_sgpa_list):
        print('{3:<5} {0:15} {1:25} {2:<5}'.format(marks[0],marks[1],marks[2], i+1), file=f)


# print(soup.prettify())

# with open("test.html", "w") as file:
#     file.write(str(soup))
